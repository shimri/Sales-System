### Sales API - Create Order Endpoint
### Base URL: http://localhost:3000
###
### Note: Product availability is now checked before order confirmation.
### Available products in mock inventory:
###   - product-1: 100 units
###   - product-2: 50 units
###   - product-3: 200 units
###   - product-4: 75 units
###   - product-5: 30 units
###
### SECURITY: All endpoints require JWT authentication via Authorization header.
### Format: Authorization: Bearer <jwt-token>
### The JWT token must contain a 'userId' claim that matches the userId in the request body.
### Example token payload: { "userId": "user-123", "email": "user@example.com" }
###
### To generate a test token, use a JWT library or online tool with your JWT_SECRET.
### Example using jwt.io: Use HS256 algorithm with your secret to sign a token with the payload above.

### Create Order - Basic Request (Success)
### This should succeed as product-1 has 100 units available
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-123"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-123",
  "idempotencyKey": "unique-key-123456",
  "items": [
    {
      "productId": "product-1",
      "quantity": 2,
      "price": 29.99,
      "name": "Sample Product"
    }
  ],
  "amount": 59.98
}

### Create Order - With Multiple Items (Success)
### This should succeed as all products are available
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-456"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-456",
  "idempotencyKey": "unique-key-789012",
  "items": [
    {
      "productId": "product-1",
      "quantity": 10,
      "price": 29.99,
      "name": "Product 1"
    },
    {
      "productId": "product-2",
      "quantity": 5,
      "price": 15.50,
      "name": "Product 2"
    },
    {
      "productId": "product-3",
      "quantity": 20,
      "price": 9.99,
      "name": "Product 3"
    }
  ],
  "amount": 524.40
}

### Create Order - Minimal Request (Success)
### This should succeed as product-3 has 200 units available
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-789"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-789",
  "idempotencyKey": "unique-key-345678",
  "items": [
    {
      "productId": "product-3",
      "quantity": 1,
      "price": 10.00
    }
  ],
  "amount": 10.00
}

### Create Order - Product Unavailable (Failure)
### This should fail with 400 Bad Request - product-2 only has 50 units, requesting 100
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-999"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-999",
  "idempotencyKey": "unique-key-999999",
  "items": [
    {
      "productId": "product-2",
      "quantity": 100,
      "price": 15.50,
      "name": "Product 2"
    }
  ],
  "amount": 1550.00
}

### Create Order - Multiple Products, One Unavailable (Failure)
### This should fail - product-5 only has 30 units, requesting 50
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-888"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-888",
  "idempotencyKey": "unique-key-888888",
  "items": [
    {
      "productId": "product-1",
      "quantity": 10,
      "price": 29.99,
      "name": "Product 1"
    },
    {
      "productId": "product-5",
      "quantity": 50,
      "price": 19.99,
      "name": "Product 5"
    }
  ],
  "amount": 1298.90
}

### Create Order - Non-existent Product (Failure)
### This should fail - product-999 doesn't exist in inventory
### Note: Replace <your-jwt-token> with a valid JWT token containing userId: "user-777"
POST http://localhost:3000/orders
Content-Type: application/json
Authorization: Bearer <your-jwt-token>

{
  "userId": "user-777",
  "idempotencyKey": "unique-key-777777",
  "items": [
    {
      "productId": "product-999",
      "quantity": 1,
      "price": 10.00,
      "name": "Non-existent Product"
    }
  ],
  "amount": 10.00
}

